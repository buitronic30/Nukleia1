<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NUKLEIA - Análisis Facial con Inteligencia Artificial</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDF9F3; /* Blanco hueso */
            color: #4A4A4A;
        }
        .salmon-pink {
            background-color: #FFB6C1; /* Salmón rosado */
        }
        .golden-pastel {
            background-color: #FFECB3; /* Pastel dorado */
        }
        .text-salmon-pink {
            color: #FF6347; /* Salmón */
        }
        .btn-primary {
            background-color: #FF6347;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .btn-primary:hover {
            background-color: #FF4500;
            transform: translateY(-2px);
        }
        .border-salmon {
            border-color: #FFB6C1;
        }
        .custom-card {
            background-color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-radius: 1rem;
            padding: 2rem;
        }
        .progress-bar {
            background-color: #e5e7eb;
            border-radius: 9999px;
            overflow: hidden;
            height: 1.5rem;
        }
        .progress-fill {
            background-color: #FFB6C1;
            height: 100%;
            transition: width 1s ease-in-out;
        }
        #video-container, #image-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            height: auto;
            border-radius: 1rem;
            overflow: hidden;
            margin: 0 auto;
        }
        #camera-feed, #analyzed-image {
            width: 100%;
            height: auto;
            display: block;
        }
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .procedure-card {
            background-color: #FFECB3;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        .procedure-card:hover {
            transform: translateY(-5px);
        }
        .procedure-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-bottom: 3px solid #FFB6C1;
        }
    </style>
</head>
<body class="antialiased">

    <main class="container mx-auto p-4 md:p-8 min-h-screen flex flex-col items-center">
        <!-- Encabezado de la página -->
        <header class="text-center my-8">
            <h1 class="text-5xl md:text-6xl font-extrabold text-salmon-pink">NUKLEIA</h1>
            <p class="mt-4 text-xl md:text-2xl text-gray-700">Tu aliado en el cuidado de la piel, potenciado por Inteligencia Artificial.</p>
        </header>

        <!-- Introducción y Guía -->
        <section id="intro-section" class="w-full max-w-4xl custom-card text-center mb-8">
            <h2 class="text-3xl font-bold mb-4 text-gray-800">¿Qué es NUKLEIA?</h2>
            <p class="text-gray-600 mb-6 leading-relaxed">NUKLEIA es una herramienta innovadora que utiliza inteligencia artificial avanzada para analizar tu rostro y ofrecerte recomendaciones personalizadas para el cuidado de tu piel. Nuestro objetivo es brindarte un análisis preciso y guiarte hacia las mejores soluciones para lucir una piel radiante y saludable.</p>
            <h3 class="text-2xl font-semibold mt-8 mb-4 text-gray-800">Cómo usar el análisis facial:</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="flex flex-col items-center p-4 rounded-lg golden-pastel">
                    <span class="text-4xl mb-2"><i class="fas fa-camera"></i></span>
                    <p class="font-semibold">1. Habilita tu cámara</p>
                    <p class="text-sm mt-1 text-gray-600">Asegúrate de tener buena luz y el rostro despejado.</p>
                </div>
                <div class="flex flex-col items-center p-4 rounded-lg golden-pastel">
                    <span class="text-4xl mb-2"><i class="fas fa-microchip"></i></span>
                    <p class="font-semibold">2. Análisis inteligente</p>
                    <p class="text-sm mt-1 text-gray-600">Nuestra IA procesará la imagen en tiempo real para detectar arrugas, la edad de la piel, y más.</p>
                </div>
                <div class="flex flex-col items-center p-4 rounded-lg golden-pastel">
                    <span class="text-4xl mb-2"><i class="fas fa-check-circle"></i></span>
                    <p class="font-semibold">3. Obtén tus resultados</p>
                    <p class="text-sm mt-1 text-gray-600">Recibirás un informe detallado con recomendaciones personalizadas.</p>
                </div>
            </div>
            <button id="start-analysis-btn" class="mt-8 btn-primary">Comenzar Análisis en Vivo</button>
        </section>

        <!-- Sección de Cámara y Análisis (oculta por defecto) -->
        <section id="analysis-section" class="hidden w-full max-w-4xl custom-card text-center mb-8">
            <h2 class="text-3xl font-bold mb-6 text-gray-800">Análisis Facial en Vivo</h2>
            <div id="video-container" class="mb-4">
                <video id="camera-feed" class="rounded-lg" autoplay playsinline></video>
                <div class="overlay hidden" id="overlay">Analizando...</div>
            </div>
            <p id="error-message" class="text-red-500 mt-4 hidden"></p>
            <button id="take-photo-btn" class="btn-primary mt-4">Tomar Foto para Analizar</button>
        </section>

        <!-- Sección de Resultados (oculta por defecto) -->
        <section id="results-section" class="hidden w-full max-w-4xl custom-card mb-8">
            <h2 class="text-3xl font-bold mb-6 text-center text-gray-800">Tus Resultados de Análisis</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div id="image-container">
                    <img id="analyzed-image" class="rounded-lg w-full h-auto mb-4" src="" alt="Foto analizada">
                </div>
                <div>
                    <h3 class="text-2xl font-semibold mb-4 text-gray-800">Resumen del Análisis de Piel</h3>
                    <div class="mb-4">
                        <p class="text-lg font-medium">Edad de la piel (Estimada por IA): <span id="skin-age" class="font-bold text-salmon-pink">28 años</span></p>
                        <div class="progress-bar mt-2">
                            <div id="skin-age-progress" class="progress-fill" style="width: 70%;"></div>
                        </div>
                    </div>
                    <div class="mb-4">
                        <p class="text-lg font-medium">Nivel de arrugas: <span id="wrinkle-level" class="font-bold text-salmon-pink">Leve</span></p>
                        <div class="progress-bar mt-2">
                            <div id="wrinkle-progress" class="progress-fill" style="width: 30%;"></div>
                        </div>
                    </div>
                    <div class="mb-4">
                        <p class="text-lg font-medium">Uniformidad del tono: <span id="tone-uniformity" class="font-bold text-salmon-pink">Alta</span></p>
                        <div class="progress-bar mt-2">
                            <div id="tone-progress" class="progress-fill" style="width: 90%;"></div>
                        </div>
                    </div>
                    <div class="mb-4">
                        <p class="text-lg font-medium">Densidad de poros: <span id="pore-density" class="font-bold text-salmon-pink">Baja</span></p>
                        <div class="progress-bar mt-2">
                            <div id="pore-progress" class="progress-fill" style="width: 25%;"></div>
                        </div>
                    </div>
                    <h3 class="text-xl font-semibold mt-6 mb-2 text-gray-800">Recomendaciones de NUKLEIA</h3>
                    <p id="recommendation-text" class="text-gray-600"></p>
                </div>
            </div>

            <!-- Recomendaciones de Tratamientos -->
            <div class="mt-8">
                <h3 class="text-3xl font-bold text-center mb-6 text-gray-800">Procedimientos Recomendados para ti</h3>
                <div id="procedures-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Procedimientos dinámicos aquí -->
                </div>
            </div>

            <!-- Botones de Acción -->
            <div class="flex flex-col md:flex-row justify-center items-center space-y-4 md:space-y-0 md:space-x-4 mt-10">
                <a href="https://wa.me/5491126572893" target="_blank" class="btn-primary text-center">
                    Solicitar turno con MB Estética y Salud
                </a>
                <button id="contact-derm-btn" class="btn-primary text-center">
                    Contactar a un Médico Dermatólogo
                </button>
                <button id="buy-serum-btn" class="btn-primary text-center">
                    Comprar NUKLEIA Serum
                </button>
            </div>
        </section>

        <!-- Sección de Popup de Contacto -->
        <div id="contact-popup" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex justify-center items-center p-4 z-50">
            <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-md">
                <h3 class="text-2xl font-bold mb-4 text-gray-800">Contactar a un Dermatólogo</h3>
                <p class="text-gray-600 mb-4">Por favor, déjanos tus datos y nos pondremos en contacto contigo.</p>
                <form id="contact-form">
                    <div class="mb-4">
                        <label for="name" class="block text-gray-700 font-semibold mb-2">Nombre</label>
                        <input type="text" id="name" name="name" class="w-full p-2 border border-gray-300 rounded-lg">
                    </div>
                    <div class="mb-4">
                        <label for="email" class="block text-gray-700 font-semibold mb-2">Email</label>
                        <input type="email" id="email" name="email" class="w-full p-2 border border-gray-300 rounded-lg">
                    </div>
                    <div class="flex justify-end space-x-2">
                        <button type="button" id="close-popup-btn" class="bg-gray-200 text-gray-700 font-semibold py-2 px-4 rounded-full">Cancelar</button>
                        <button type="submit" class="btn-primary">Enviar</button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const startBtn = document.getElementById('start-analysis-btn');
            const analysisSection = document.getElementById('analysis-section');
            const introSection = document.getElementById('intro-section');
            const takePhotoBtn = document.getElementById('take-photo-btn');
            const cameraFeed = document.getElementById('camera-feed');
            const overlay = document.getElementById('overlay');
            const resultsSection = document.getElementById('results-section');
            const errorMessage = document.getElementById('error-message');
            const analyzedImage = document.getElementById('analyzed-image');
            const skinAgeEl = document.getElementById('skin-age');
            const wrinkleLevelEl = document.getElementById('wrinkle-level');
            const toneUniformityEl = document.getElementById('tone-uniformity');
            const poreDensityEl = document.getElementById('pore-density');
            const skinAgeProgress = document.getElementById('skin-age-progress');
            const wrinkleProgress = document.getElementById('wrinkle-progress');
            const toneProgress = document.getElementById('tone-progress');
            const poreProgress = document.getElementById('pore-progress');
            const recommendationText = document.getElementById('recommendation-text');
            const proceduresList = document.getElementById('procedures-list');
            const contactDermBtn = document.getElementById('contact-derm-btn');
            const buySerumBtn = document.getElementById('buy-serum-btn');
            const contactPopup = document.getElementById('contact-popup');
            const closePopupBtn = document.getElementById('close-popup-btn');

            let cameraStream = null;

            // --- Lógica del Flujo de la Página ---

            // Botón para comenzar el análisis y activar la cámara
            startBtn.addEventListener('click', () => {
                introSection.classList.add('hidden');
                analysisSection.classList.remove('hidden');
                
                // Pedir permiso para acceder a la cámara
                navigator.mediaDevices.getUserMedia({ video: true })
                    .then(stream => {
                        cameraStream = stream;
                        cameraFeed.srcObject = stream;
                        cameraFeed.play();
                    })
                    .catch(err => {
                        console.error("Error al acceder a la cámara: ", err);
                        errorMessage.textContent = 'No se pudo acceder a la cámara. Por favor, verifica los permisos.';
                        errorMessage.classList.remove('hidden');
                        takePhotoBtn.disabled = true;
                    });
            });

            // Botón para tomar la foto y analizar
            takePhotoBtn.addEventListener('click', () => {
                if (!cameraStream) {
                    errorMessage.textContent = 'Por favor, activa la cámara primero.';
                    errorMessage.classList.remove('hidden');
                    return;
                }

                // Crear un canvas para capturar la imagen del video
                const canvas = document.createElement('canvas');
                canvas.width = cameraFeed.videoWidth;
                canvas.height = cameraFeed.videoHeight;
                const context = canvas.getContext('2d');
                context.drawImage(cameraFeed, 0, 0, canvas.width, canvas.height);

                // Detener el stream de la cámara
                cameraStream.getTracks().forEach(track => track.stop());

                // Mostrar el overlay de "Analizando..."
                overlay.classList.remove('hidden');
                
                setTimeout(() => {
                    // Ocultar el overlay
                    overlay.classList.add('hidden');
                    analysisSection.classList.add('hidden');
                    resultsSection.classList.remove('hidden');
                    
                    // Mostrar la imagen capturada
                    const imageDataURL = canvas.toDataURL('image/jpeg');
                    analyzedImage.src = imageDataURL;
                    
                    // Simular resultados de la IA (estos valores serían dinámicos con una IA real)
                    const results = generateFakeResults();
                    displayResults(results);

                }, 3000); // 3 segundos de espera para simular el análisis
            });

            // Lógica para el popup de contacto
            contactDermBtn.addEventListener('click', () => {
                contactPopup.classList.remove('hidden');
            });

            closePopupBtn.addEventListener('click', () => {
                contactPopup.classList.add('hidden');
            });
            
            // Simulación de los resultados de la IA
            function generateFakeResults() {
                const results = {
                    skinAge: Math.floor(Math.random() * (45 - 20 + 1)) + 20,
                    wrinkleLevel: Math.random(),
                    toneUniformity: Math.random(),
                    poreDensity: Math.random(),
                };
                
                let recommendations = `Basado en tu análisis, NUKLEIA SERUM es ideal para ti. Sus componentes clave, los **polinucleótidos** y **exosomas**, derivados del salmón, ayudan a regenerar y revitalizar la piel.`;

                if (results.wrinkleLevel > 0.6) {
                    recommendations += ` Se ha detectado una alta presencia de líneas de expresión, por lo que el serum ayudará a suavizarlas estimulando la producción de colágeno y elastina.`;
                }
                if (results.toneUniformity < 0.4) {
                    recommendations += ` La falta de uniformidad en el tono de tu piel puede ser tratada con el serum, que promueve la regeneración celular y unifica la pigmentación.`;
                }

                const procedures = [
                    { name: 'Facefit', description: 'Un procedimiento de remodelación facial no quirúrgica para mejorar el contorno y la elasticidad.', image: 'https://placehold.co/400x200/FFECB3/FF6347?text=Facefit' },
                    { name: 'Limpieza Facial Profunda', description: 'Ayuda a eliminar impurezas, células muertas y puntos negros, mejorando la textura de la piel.', image: 'https://placehold.co/400x200/FFECB3/FF6347?text=Limpieza+Facial' },
                    { name: 'Dermapen', description: 'Técnica de micro-punciones que estimula la producción de colágeno, ideal para tratar arrugas y cicatrices.', image: 'https://placehold.co/400x200/FFECB3/FF6347?text=Dermapen' },
                    { name: 'Radiofrecuencia', description: 'Tratamiento que utiliza calor para reafirmar la piel, reducir arrugas y mejorar la circulación.', image: 'https://placehold.co/400x200/FFECB3/FF6347?text=Radiofrecuencia' },
                    { name: 'Peeling Químico', description: 'Exfoliación profunda para renovar las capas de la piel y mejorar su apariencia.', image: 'https://placehold.co/400x200/FFECB3/FF6347?text=Peeling+Quimico' }
                ];
                
                const recommendedProcedures = [];
                for (let i = 0; i < 3; i++) {
                    const randomIndex = Math.floor(Math.random() * procedures.length);
                    recommendedProcedures.push(procedures.splice(randomIndex, 1)[0]);
                }
                
                return {
                    ...results,
                    recommendationText: recommendations,
                    procedures: recommendedProcedures
                };
            }

            // Muestra los resultados en la página
            function displayResults(results) {
                skinAgeEl.textContent = `${results.skinAge} años`;
                wrinkleLevelEl.textContent = results.wrinkleLevel > 0.7 ? 'Alta' : results.wrinkleLevel > 0.4 ? 'Moderada' : 'Leve';
                toneUniformityEl.textContent = results.toneUniformity > 0.7 ? 'Alta' : results.toneUniformity > 0.4 ? 'Moderada' : 'Baja';
                poreDensityEl.textContent = results.poreDensity > 0.7 ? 'Alta' : results.poreDensity > 0.4 ? 'Moderada' : 'Baja';

                skinAgeProgress.style.width = `${100 - (results.skinAge - 20) * 2.5}%`;
                wrinkleProgress.style.width = `${results.wrinkleLevel * 100}%`;
                toneProgress.style.width = `${results.toneUniformity * 100}%`;
                poreProgress.style.width = `${results.poreDensity * 100}%`;
                
                recommendationText.innerHTML = results.recommendationText;

                proceduresList.innerHTML = '';
                results.procedures.forEach(proc => {
                    const card = document.createElement('div');
                    card.className = 'procedure-card';
                    card.innerHTML = `
                        <img src="${proc.image}" alt="${proc.name}" class="procedure-image">
                        <div class="p-4">
                            <h4 class="text-xl font-bold text-gray-800 mb-2">${proc.name}</h4>
                            <p class="text-gray-600 text-sm">${proc.description}</p>
                        </div>
                    `;
                    proceduresList.appendChild(card);
                });
            }
        });
    </script>

</body>
</html>

